<div id="progress_department" class="section-view space-y-8">
  <!-- Header -->
  <div
    class="flex flex-col md:flex-row gap-6 items-start md:items-center justify-between"
  >
    <div>
      <h2 class="text-2xl font-black text-slate-800">
        Tiến độ học tập - Khoa KH&KT Máy tính
      </h2>
      <p class="text-slate-500">Báo cáo chi tiết học kỳ HK251</p>
    </div>
    <div class="flex gap-3">
      <button
        onclick="exportProgressToCSV('dept-risk-list')"
        class="px-4 py-2 bg-white/60 border border-white text-slate-600 rounded-xl font-bold hover:bg-white hover:text-blue-600 transition shadow-sm"
      >
        <i class="fa-solid fa-file-csv mr-2"></i>Xuất Excel
      </button>
      <button
        class="px-4 py-2 bg-white/60 border border-white text-slate-600 rounded-xl font-bold hover:bg-white hover:text-blue-600 transition shadow-sm"
      >
        <i class="fa-solid fa-print mr-2"></i>In báo cáo
      </button>
    </div>
  </div>

  <!-- KPI Cards -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
    <div class="glass-card p-6 rounded-[24px] flex flex-col justify-between">
      <p class="text-xs font-bold text-slate-500 uppercase mb-2">
        GPA Trung bình Khoa
      </p>
      <p class="text-4xl font-black text-slate-800">3.24</p>
      <div class="mt-2 text-xs font-bold text-green-600 flex items-center">
        <i class="fa-solid fa-arrow-trend-up mr-1"></i> +0.15 so với HK trước
      </div>
    </div>
    <div class="glass-card p-6 rounded-[24px] flex flex-col justify-between">
      <p class="text-xs font-bold text-slate-500 uppercase mb-2">
        Tỷ lệ qua môn
      </p>
      <p class="text-4xl font-black text-slate-800">94%</p>
      <div class="w-full bg-slate-200 h-1.5 rounded-full mt-3">
        <div class="bg-blue-500 h-1.5 rounded-full" style="width: 94%"></div>
      </div>
    </div>
    <div class="glass-card p-6 rounded-[24px] flex flex-col justify-between">
      <p class="text-xs font-bold text-slate-500 uppercase mb-2">
        Sinh viên Xuất sắc
      </p>
      <p class="text-4xl font-black text-slate-800">320</p>
      <p class="text-xs text-slate-400 mt-1">GPA >= 3.6</p>
    </div>
    <div
      class="glass-card p-6 rounded-[24px] flex flex-col justify-between border border-red-200 bg-red-50/50"
    >
      <p class="text-xs font-bold text-red-500 uppercase mb-2">
        Cảnh báo Học vụ
      </p>
      <p class="text-4xl font-black text-red-600">12</p>
      <p class="text-xs text-red-400 mt-1">Cần tư vấn ngay</p>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Chart 1: Comparison (Reusing Admin Chart for now) -->
    <div class="glass-card p-6 rounded-[28px]">
      <h3 class="font-bold text-slate-800 mb-4">So sánh với các Khoa khác</h3>
      <canvas id="deptComparisonChart_dept" height="250"></canvas>
    </div>

    <!-- Chart 2: Grade Distribution -->
    <div class="glass-card p-6 rounded-[28px]">
      <h3 class="font-bold text-slate-800 mb-4">Phân bố điểm số Khoa</h3>
      <canvas id="systemGradeDistChart_dept" height="250"></canvas>
    </div>
  </div>

  <!-- At Risk Table -->
  <div class="glass-card p-6 rounded-[28px]">
    <div class="flex justify-between items-center mb-6">
      <h3 class="font-bold text-red-600 flex items-center gap-2">
        <i class="fa-solid fa-triangle-exclamation"></i> Sinh viên Khoa cần theo
        dõi
      </h3>
      <div class="relative">
        <i
          class="fa-solid fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs"
        ></i>
        <input
          type="text"
          placeholder="Tìm kiếm sinh viên..."
          class="pl-9 pr-4 py-2 bg-slate-50 border-none rounded-xl text-sm font-bold text-slate-600 focus:ring-2 focus:ring-blue-500 w-64"
        />
      </div>
    </div>

    <div class="overflow-x-auto">
      <table class="w-full text-left border-collapse" id="dept-risk-list">
        <thead>
          <tr
            class="text-slate-500 text-xs uppercase tracking-wider border-b border-slate-200/60"
          >
            <th class="pb-3 pl-4 font-bold">MSSV</th>
            <th class="pb-3 font-bold">Họ và tên</th>
            <th class="pb-3 font-bold">Lớp SH</th>
            <th class="pb-3 font-bold">GPA</th>
            <th class="pb-3 font-bold">Số môn nợ</th>
            <th class="pb-3 font-bold text-right pr-4">Tình trạng</th>
          </tr>
        </thead>
        <tbody class="text-sm text-slate-700">
          <!-- Sample Data for Department -->
          <tr
            class="border-b border-slate-100 hover:bg-red-50/50 transition progress-row"
            data-mssv="2011001"
            data-name="Lê Văn Hỏng"
            data-percent="1.2"
          >
            <td class="py-4 pl-4 font-mono text-slate-500">2011001</td>
            <td class="py-4 font-bold">Lê Văn Hỏng</td>
            <td class="py-4">MT20KH01</td>
            <td class="py-4 font-bold text-red-600">1.2</td>
            <td class="py-4">4</td>
            <td class="py-4 text-right pr-4">
              <span
                class="px-2 py-1 bg-red-100 text-red-600 rounded text-xs font-bold"
                >Nguy cấp</span
              >
            </td>
          </tr>
          <tr
            class="border-b border-slate-100 hover:bg-red-50/50 transition progress-row"
            data-mssv="2110456"
            data-name="Trần Thị B"
            data-percent="1.9"
          >
            <td class="py-4 pl-4 font-mono text-slate-500">2110456</td>
            <td class="py-4 font-bold">Trần Thị B</td>
            <td class="py-4">MT21KH02</td>
            <td class="py-4 font-bold text-red-600">1.9</td>
            <td class="py-4">2</td>
            <td class="py-4 text-right pr-4">
              <span
                class="px-2 py-1 bg-orange-100 text-orange-600 rounded text-xs font-bold"
                >Cảnh báo</span
              >
            </td>
          </tr>
          <tr
            class="border-b border-slate-100 hover:bg-red-50/50 transition progress-row"
            data-mssv="2210789"
            data-name="Nguyễn Văn C"
            data-percent="1.5"
          >
            <td class="py-4 pl-4 font-mono text-slate-500">2210789</td>
            <td class="py-4 font-bold">Nguyễn Văn C</td>
            <td class="py-4">MT22KH01</td>
            <td class="py-4 font-bold text-red-600">1.5</td>
            <td class="py-4">3</td>
            <td class="py-4 text-right pr-4">
              <span
                class="px-2 py-1 bg-red-100 text-red-600 rounded text-xs font-bold"
                >Nguy cấp</span
              >
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
